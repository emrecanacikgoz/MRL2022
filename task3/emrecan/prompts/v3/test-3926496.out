Setting stack size to unlimited...
core file size          (blocks, -c) 0
data seg size           (kbytes, -d) unlimited
scheduling priority             (-e) 0
file size               (blocks, -f) unlimited
pending signals                 (-i) 2061323
max locked memory       (kbytes, -l) unlimited
max memory size         (kbytes, -m) 20971520
open files                      (-n) 51200
pipe size            (512 bytes, -p) 8
POSIX message queues     (bytes, -q) 819200
real-time priority              (-r) 0
stack size              (kbytes, -s) unlimited
cpu time               (seconds, -t) unlimited
max user processes              (-u) 4096
virtual memory          (kbytes, -v) unlimited
file locks                      (-x) unlimited

Tue Aug  2 16:40:52 2022       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 470.57.02    Driver Version: 470.57.02    CUDA Version: 11.4     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  Tesla T4            Off  | 00000000:40:00.0 Off |                    0 |
| N/A   32C    P0    26W /  70W |      0MiB / 15109MiB |      7%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
Using pad_token, but it is not set yet.
Namespace(lang='fra', lr=5e-05, model='gpt2', model_name_or_path='sberbank-ai/mGPT', plm_eval_mode=False, run=2)
{
  "guid": 0,
  "label": null,
  "meta": {},
  "text_a": "me la trouv\u00e8rent-ils?",
  "text_b": "",
  "tgt_text": "trouver:IND,PST,LGSPEC1,NOM(3,PL,MASC),ACC(3,SG,FEM),DAT(1,SG),Q"
}

[[{'text': 'me la trouv√®rent-ils?', 'loss_ids': 0, 'shortenable_ids': 1}, {'text': '<mask>', 'loss_ids': 1, 'shortenable_ids': 0}], {'guid': 0, 'tgt_text': 'trouver:IND,PST,LGSPEC1,NOM(3,PL,MASC),ACC(3,SG,FEM),DAT(1,SG),Q'}]
tokenizing: 0it [00:00, ?it/s]tokenizing: 89it [00:00, 887.56it/s]tokenizing: 232it [00:00, 1205.63it/s]tokenizing: 383it [00:00, 1342.29it/s]tokenizing: 536it [00:00, 1413.97it/s]tokenizing: 690it [00:00, 1455.92it/s]tokenizing: 843it [00:00, 1479.61it/s]tokenizing: 996it [00:00, 1495.94it/s]tokenizing: 1160it [00:00, 1540.12it/s]tokenizing: 1358it [00:00, 1675.05it/s]tokenizing: 1560it [00:01, 1779.91it/s]tokenizing: 1767it [00:01, 1866.03it/s]tokenizing: 1971it [00:01, 1917.02it/s]tokenizing: 2170it [00:01, 1936.90it/s]tokenizing: 2367it [00:01, 1944.49it/s]tokenizing: 2575it [00:01, 1984.44it/s]tokenizing: 2792it [00:01, 2037.81it/s]tokenizing: 3005it [00:01, 2063.82it/s]tokenizing: 3220it [00:01, 2087.48it/s]tokenizing: 3432it [00:01, 2095.22it/s]tokenizing: 3642it [00:02, 2091.80it/s]tokenizing: 3852it [00:02, 1636.55it/s]tokenizing: 4065it [00:02, 1759.22it/s]tokenizing: 4277it [00:02, 1852.96it/s]tokenizing: 4489it [00:02, 1924.02it/s]tokenizing: 4710it [00:02, 2001.92it/s]tokenizing: 4926it [00:02, 2046.34it/s]tokenizing: 5136it [00:02, 2059.86it/s]tokenizing: 5346it [00:02, 2052.19it/s]tokenizing: 5554it [00:03, 2047.21it/s]tokenizing: 5773it [00:03, 2087.65it/s]tokenizing: 5983it [00:03, 2070.39it/s]tokenizing: 6193it [00:03, 2078.45it/s]tokenizing: 6402it [00:03, 2068.59it/s]tokenizing: 6610it [00:03, 2053.38it/s]tokenizing: 6819it [00:03, 2063.97it/s]tokenizing: 7026it [00:03, 2056.83it/s]tokenizing: 7232it [00:03, 2047.72it/s]tokenizing: 7437it [00:03, 2042.62it/s]tokenizing: 7642it [00:04, 2036.33it/s]tokenizing: 7849it [00:04, 2043.82it/s]tokenizing: 8054it [00:04, 2034.67it/s]tokenizing: 8258it [00:04, 2034.26it/s]tokenizing: 8470it [00:04, 2059.22it/s]tokenizing: 8689it [00:04, 2096.47it/s]tokenizing: 8903it [00:04, 2109.29it/s]tokenizing: 9115it [00:04, 2109.67it/s]tokenizing: 9326it [00:04, 2100.98it/s]tokenizing: 9542it [00:04, 2117.04it/s]tokenizing: 9754it [00:05, 2116.20it/s]tokenizing: 9966it [00:05, 2110.13it/s]tokenizing: 10000it [00:05, 1943.53it/s]
tokenizing: 0it [00:00, ?it/s]tokenizing: 419it [00:00, 4181.06it/s]tokenizing: 849it [00:00, 4246.97it/s]tokenizing: 1000it [00:00, 4229.98it/s]
tokenizing: 0it [00:00, ?it/s]tokenizing: 511it [00:00, 5106.39it/s]tokenizing: 1000it [00:00, 5099.12it/s]Epoch 0, global_step 500 average loss: 23.66772864818573 lr: 4.75e-05
Epoch 0, global_step 1000 average loss: 5.994374704480172 lr: 4.5e-05
Epoch 0, global_step 1500 average loss: 2.739154868453741 lr: 4.25e-05
Epoch 0, global_step 2000 average loss: 1.8835443571805954 lr: 4e-05
acc: 0.687
Epoch 1, global_step 2500 average loss: 1.3998158387690782 lr: 3.7500000000000003e-05
Epoch 1, global_step 3000 average loss: 1.2166887718215584 lr: 3.5e-05
Epoch 1, global_step 3500 average loss: 1.0606561509352177 lr: 3.2500000000000004e-05
Epoch 1, global_step 4000 average loss: 0.9318380869422108 lr: 3e-05
acc: 0.749
Epoch 2, global_step 4500 average loss: 0.7604789242378902 lr: 2.7500000000000004e-05
Epoch 2, global_step 5000 average loss: 0.7284966730703599 lr: 2.5e-05
Epoch 2, global_step 5500 average loss: 0.6785028441513423 lr: 2.25e-05
Epoch 2, global_step 6000 average loss: 0.5604545586045133 lr: 2e-05
acc: 0.792
Epoch 3, global_step 6500 average loss: 0.4981131695706863 lr: 1.75e-05
Epoch 3, global_step 7000 average loss: 0.5106410201400867 lr: 1.5e-05
Epoch 3, global_step 7500 average loss: 0.4177545290373964 lr: 1.25e-05
Epoch 3, global_step 8000 average loss: 0.3536948940853763 lr: 1e-05
acc: 0.783
Epoch 4, global_step 8500 average loss: 0.3369866304351235 lr: 7.5e-06
Epoch 4, global_step 9000 average loss: 0.2792722564554715 lr: 5e-06
Epoch 4, global_step 9500 average loss: 0.33576066917585556 lr: 2.5e-06
Epoch 4, global_step 10000 average loss: 0.2547933489808056 lr: 0.0
acc: 0.794
Epoch 5, global_step 10500 average loss: 0.23883311360482185 lr: 0.0
Epoch 5, global_step 11000 average loss: 0.2167704342347861 lr: 0.0
Epoch 5, global_step 11500 average loss: 0.2412491191860463 lr: 0.0
Epoch 5, global_step 12000 average loss: 0.2381893386253214 lr: 0.0

/kuacc/users/eacikgoz17/.conda/envs/eacikgoz17/lib/python3.8/site-packages/transformers/optimization.py:306: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
acc: 0.794
DeprecationWarning: 'source deactivate' is deprecated. Use 'conda deactivate'.
