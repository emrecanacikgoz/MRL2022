Setting stack size to unlimited...
core file size          (blocks, -c) 0
data seg size           (kbytes, -d) unlimited
scheduling priority             (-e) 0
file size               (blocks, -f) unlimited
pending signals                 (-i) 2061310
max locked memory       (kbytes, -l) unlimited
max memory size         (kbytes, -m) 20971520
open files                      (-n) 51200
pipe size            (512 bytes, -p) 8
POSIX message queues     (bytes, -q) 819200
real-time priority              (-r) 0
stack size              (kbytes, -s) unlimited
cpu time               (seconds, -t) unlimited
max user processes              (-u) 4096
virtual memory          (kbytes, -v) unlimited
file locks                      (-x) unlimited

Wed Aug  3 14:04:40 2022       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 470.57.02    Driver Version: 470.57.02    CUDA Version: 11.4     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  Tesla T4            Off  | 00000000:40:00.0 Off |                    0 |
| N/A   34C    P0    26W /  70W |      0MiB / 15109MiB |      5%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
Using pad_token, but it is not set yet.
Namespace(lang='fra', lr=5e-05, model='gpt2', model_name_or_path='sberbank-ai/mGPT', plm_eval_mode=False, run=2)
{
  "guid": 0,
  "label": null,
  "meta": {},
  "text_a": "me la trouv\u00e8rent-ils?",
  "text_b": "",
  "tgt_text": "trouver:IND;PST;LGSPEC1;NOM(3,PL,MASC);ACC(3,SG,FEM);DAT(1,SG);Q"
}

[[{'text': 'me la trouv√®rent-ils?', 'loss_ids': 0, 'shortenable_ids': 1}, {'text': '<mask>', 'loss_ids': 1, 'shortenable_ids': 0}], {'guid': 0, 'tgt_text': 'trouver:IND;PST;LGSPEC1;NOM(3,PL,MASC);ACC(3,SG,FEM);DAT(1,SG);Q'}]
tokenizing: 0it [00:00, ?it/s]tokenizing: 133it [00:00, 1322.46it/s]tokenizing: 287it [00:00, 1448.84it/s]tokenizing: 437it [00:00, 1472.04it/s]tokenizing: 585it [00:00, 1463.78it/s]tokenizing: 738it [00:00, 1484.17it/s]tokenizing: 937it [00:00, 1653.62it/s]tokenizing: 1144it [00:00, 1786.99it/s]tokenizing: 1349it [00:00, 1869.23it/s]tokenizing: 1551it [00:00, 1913.68it/s]tokenizing: 1757it [00:01, 1957.18it/s]tokenizing: 1957it [00:01, 1969.10it/s]tokenizing: 2156it [00:01, 1974.74it/s]tokenizing: 2358it [00:01, 1986.13it/s]tokenizing: 2563it [00:01, 2005.01it/s]tokenizing: 2773it [00:01, 2031.27it/s]tokenizing: 2977it [00:01, 2014.18it/s]tokenizing: 3179it [00:01, 1985.85it/s]tokenizing: 3384it [00:01, 2004.05it/s]tokenizing: 3585it [00:01, 2002.29it/s]tokenizing: 3790it [00:02, 2014.54it/s]tokenizing: 3992it [00:02, 1607.57it/s]tokenizing: 4185it [00:02, 1688.87it/s]tokenizing: 4390it [00:02, 1782.67it/s]tokenizing: 4595it [00:02, 1856.11it/s]tokenizing: 4800it [00:02, 1910.43it/s]tokenizing: 5009it [00:02, 1959.63it/s]tokenizing: 5211it [00:02, 1976.89it/s]tokenizing: 5412it [00:02, 1962.07it/s]tokenizing: 5619it [00:03, 1991.86it/s]tokenizing: 5826it [00:03, 2012.93it/s]tokenizing: 6029it [00:03, 2009.10it/s]tokenizing: 6236it [00:03, 2023.72it/s]tokenizing: 6448it [00:03, 2051.49it/s]tokenizing: 6654it [00:03, 2053.56it/s]tokenizing: 6867it [00:03, 2075.45it/s]tokenizing: 7085it [00:03, 2106.44it/s]tokenizing: 7299it [00:03, 2115.57it/s]tokenizing: 7511it [00:03, 2116.67it/s]tokenizing: 7730it [00:04, 2136.08it/s]tokenizing: 7957it [00:04, 2175.01it/s]tokenizing: 8183it [00:04, 2199.90it/s]tokenizing: 8414it [00:04, 2230.25it/s]tokenizing: 8652it [00:04, 2271.95it/s]tokenizing: 8883it [00:04, 2282.66it/s]tokenizing: 9114it [00:04, 2288.65it/s]tokenizing: 9343it [00:04, 2286.04it/s]tokenizing: 9572it [00:04, 2272.93it/s]tokenizing: 9806it [00:04, 2290.32it/s]tokenizing: 10000it [00:04, 2000.07it/s]
tokenizing: 0it [00:00, ?it/s]tokenizing: 495it [00:00, 4948.09it/s]tokenizing: 992it [00:00, 4957.89it/s]tokenizing: 1000it [00:00, 4941.52it/s]
tokenizing: 0it [00:00, ?it/s]tokenizing: 578it [00:00, 5775.96it/s]tokenizing: 1000it [00:00, 5655.15it/s]Epoch 0, global_step 500 average loss: 23.765407272338866 lr: 4.75e-05
Epoch 0, global_step 1000 average loss: 6.441054357528687 lr: 4.5e-05
Epoch 0, global_step 1500 average loss: 3.241193854212761 lr: 4.25e-05
Epoch 0, global_step 2000 average loss: 1.9860050848424435 lr: 4e-05
acc: 0.640
Epoch 1, global_step 2500 average loss: 1.469449887238443 lr: 3.7500000000000003e-05
Epoch 1, global_step 3000 average loss: 1.2510817541219295 lr: 3.5e-05
Epoch 1, global_step 3500 average loss: 1.0370014869291335 lr: 3.2500000000000004e-05
Epoch 1, global_step 4000 average loss: 0.9877586362250149 lr: 3e-05
acc: 0.793
Epoch 2, global_step 4500 average loss: 0.8004252711972222 lr: 2.7500000000000004e-05
Epoch 2, global_step 5000 average loss: 0.7431979060336016 lr: 2.5e-05
Epoch 2, global_step 5500 average loss: 0.637803199699847 lr: 2.25e-05
Epoch 2, global_step 6000 average loss: 0.6417309596472187 lr: 2e-05
acc: 0.803
Epoch 3, global_step 6500 average loss: 0.5517005689154612 lr: 1.75e-05
Epoch 3, global_step 7000 average loss: 0.4812913812443148 lr: 1.5e-05
Epoch 3, global_step 7500 average loss: 0.4199950627658982 lr: 1.25e-05
Epoch 3, global_step 8000 average loss: 0.38422031958993463 lr: 1e-05
acc: 0.802
Epoch 4, global_step 8500 average loss: 0.34851108309696427 lr: 7.5e-06
Epoch 4, global_step 9000 average loss: 0.33256523355215906 lr: 5e-06
Epoch 4, global_step 9500 average loss: 0.3376464788086014 lr: 2.5e-06
Epoch 4, global_step 10000 average loss: 0.24699884556411417 lr: 0.0
acc: 0.808
Epoch 5, global_step 10500 average loss: 0.28883487341535513 lr: 0.0
Epoch 5, global_step 11000 average loss: 0.2706959941254754 lr: 0.0
Epoch 5, global_step 11500 average loss: 0.24974378936595168 lr: 0.0
Epoch 5, global_step 12000 average loss: 0.24759560243008308 lr: 0.0
acc: 0.808
Epoch 6, global_step 12500 average loss: 0.2729065144343622 lr: 0.0
Epoch 6, global_step 13000 average loss: 0.27262713108144815 lr: 0.0
Epoch 6, global_step 13500 average loss: 0.25848130007275905 lr: 0.0
Epoch 6, global_step 14000 average loss: 0.2257997930116544 lr: 0.0
acc: 0.808
Epoch 7, global_step 14500 average loss: 0.2933749801025842 lr: 0.0
Epoch 7, global_step 15000 average loss: 0.25443235981813633 lr: 0.0
Epoch 7, global_step 15500 average loss: 0.30421089484379626 lr: 0.0
Epoch 7, global_step 16000 average loss: 0.27499693311376905 lr: 0.0
acc: 0.808
Epoch 8, global_step 16500 average loss: 0.2679169801925891 lr: 0.0
Epoch 8, global_step 17000 average loss: 0.2748446265219536 lr: 0.0
Epoch 8, global_step 17500 average loss: 0.26474402149107484 lr: 0.0
Epoch 8, global_step 18000 average loss: 0.23637672723119613 lr: 0.0

/kuacc/users/eacikgoz17/.conda/envs/eacikgoz17/lib/python3.8/site-packages/transformers/optimization.py:306: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
acc: 0.808
DeprecationWarning: 'source deactivate' is deprecated. Use 'conda deactivate'.
