Setting stack size to unlimited...
core file size          (blocks, -c) 0
data seg size           (kbytes, -d) unlimited
scheduling priority             (-e) 0
file size               (blocks, -f) unlimited
pending signals                 (-i) 2061307
max locked memory       (kbytes, -l) unlimited
max memory size         (kbytes, -m) 20971520
open files                      (-n) 51200
pipe size            (512 bytes, -p) 8
POSIX message queues     (bytes, -q) 819200
real-time priority              (-r) 0
stack size              (kbytes, -s) unlimited
cpu time               (seconds, -t) unlimited
max user processes              (-u) 4096
virtual memory          (kbytes, -v) unlimited
file locks                      (-x) unlimited

Tue Aug  2 16:40:20 2022       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 470.57.02    Driver Version: 470.57.02    CUDA Version: 11.4     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  Tesla T4            Off  | 00000000:1D:00.0 Off |                    0 |
| N/A   46C    P0    26W /  70W |      0MiB / 15109MiB |      0%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
Using pad_token, but it is not set yet.
Namespace(lang='eng', lr=5e-05, model='gpt2', model_name_or_path='sberbank-ai/mGPT', plm_eval_mode=False, run=2)
{
  "guid": 0,
  "label": null,
  "meta": {},
  "text_a": "wasn't I abusing myself?",
  "text_b": "",
  "tgt_text": "abuse:IND,PST,PROG,NOM(1,SG),NEG,Q,ACC(1,SG,RFLX)"
}

[[{'text': "wasn't I abusing myself?", 'loss_ids': 0, 'shortenable_ids': 1}, {'text': '<mask>', 'loss_ids': 1, 'shortenable_ids': 0}], {'guid': 0, 'tgt_text': 'abuse:IND,PST,PROG,NOM(1,SG),NEG,Q,ACC(1,SG,RFLX)'}]
tokenizing: 0it [00:00, ?it/s]tokenizing: 91it [00:00, 902.33it/s]tokenizing: 222it [00:00, 1137.20it/s]tokenizing: 386it [00:00, 1362.88it/s]tokenizing: 552it [00:00, 1477.99it/s]tokenizing: 717it [00:00, 1536.71it/s]tokenizing: 886it [00:00, 1586.30it/s]tokenizing: 1054it [00:00, 1614.10it/s]tokenizing: 1224it [00:00, 1640.61it/s]tokenizing: 1398it [00:00, 1670.98it/s]tokenizing: 1638it [00:01, 1895.57it/s]tokenizing: 1877it [00:01, 2046.62it/s]tokenizing: 2118it [00:01, 2154.22it/s]tokenizing: 2358it [00:01, 2226.66it/s]tokenizing: 2591it [00:01, 2254.83it/s]tokenizing: 2826it [00:01, 2280.96it/s]tokenizing: 3068it [00:01, 2320.66it/s]tokenizing: 3311it [00:01, 2352.88it/s]tokenizing: 3554it [00:01, 2374.97it/s]tokenizing: 3794it [00:01, 2380.25it/s]tokenizing: 4033it [00:02, 1925.62it/s]tokenizing: 4274it [00:02, 2048.67it/s]tokenizing: 4515it [00:02, 2145.07it/s]tokenizing: 4758it [00:02, 2223.68it/s]tokenizing: 4998it [00:02, 2273.26it/s]tokenizing: 5233it [00:02, 2294.99it/s]tokenizing: 5474it [00:02, 2325.75it/s]tokenizing: 5714it [00:02, 2346.19it/s]tokenizing: 5960it [00:02, 2377.76it/s]tokenizing: 6204it [00:02, 2394.14it/s]tokenizing: 6445it [00:03, 2391.08it/s]tokenizing: 6685it [00:03, 2370.01it/s]tokenizing: 6923it [00:03, 2358.62it/s]tokenizing: 7160it [00:03, 2355.38it/s]tokenizing: 7396it [00:03, 2346.82it/s]tokenizing: 7637it [00:03, 2364.36it/s]tokenizing: 7874it [00:03, 2354.05it/s]tokenizing: 8110it [00:03, 2354.41it/s]tokenizing: 8354it [00:03, 2379.22it/s]tokenizing: 8598it [00:03, 2395.24it/s]tokenizing: 8843it [00:04, 2410.07it/s]tokenizing: 9085it [00:04, 2393.03it/s]tokenizing: 9325it [00:04, 2379.05it/s]tokenizing: 9563it [00:04, 2374.56it/s]tokenizing: 9803it [00:04, 2381.12it/s]tokenizing: 10000it [00:04, 2179.33it/s]
tokenizing: 0it [00:00, ?it/s]tokenizing: 533it [00:00, 5326.21it/s]tokenizing: 1000it [00:00, 5324.07it/s]
tokenizing: 0it [00:00, ?it/s]tokenizing: 559it [00:00, 5584.00it/s]tokenizing: 1000it [00:00, 5545.45it/s]Epoch 0, global_step 500 average loss: 17.666850441455843 lr: 4.75e-05
Epoch 0, global_step 1000 average loss: 2.5312026956155895 lr: 4.5e-05
Epoch 0, global_step 1500 average loss: 0.9817435812312179 lr: 4.25e-05
Epoch 0, global_step 2000 average loss: 0.5652524043847516 lr: 4e-05
acc: 0.911
Epoch 1, global_step 2500 average loss: 0.39088527332809464 lr: 3.7500000000000003e-05
Epoch 1, global_step 3000 average loss: 0.31181353753868096 lr: 3.5e-05
Epoch 1, global_step 3500 average loss: 0.20139859910542873 lr: 3.2500000000000004e-05
Epoch 1, global_step 4000 average loss: 0.18395944631827296 lr: 3e-05
acc: 0.958
Epoch 2, global_step 4500 average loss: 0.1485660549628301 lr: 2.7500000000000004e-05
Epoch 2, global_step 5000 average loss: 0.15557641058834634 lr: 2.5e-05
Epoch 2, global_step 5500 average loss: 0.09594115460064495 lr: 2.25e-05
Epoch 2, global_step 6000 average loss: 0.08731002008500217 lr: 2e-05
acc: 0.965
Epoch 3, global_step 6500 average loss: 0.05486116923261215 lr: 1.75e-05
Epoch 3, global_step 7000 average loss: 0.08188008925981194 lr: 1.5e-05
Epoch 3, global_step 7500 average loss: 0.04825326746297287 lr: 1.25e-05
Epoch 3, global_step 8000 average loss: 0.03797064875011347 lr: 1e-05
acc: 0.962
Epoch 4, global_step 8500 average loss: 0.042632740882479994 lr: 7.5e-06
Epoch 4, global_step 9000 average loss: 0.014591391226207633 lr: 5e-06
Epoch 4, global_step 9500 average loss: 0.005546138783680363 lr: 2.5e-06
Epoch 4, global_step 10000 average loss: 0.02039308818004065 lr: 0.0
acc: 0.965
Epoch 5, global_step 10500 average loss: 0.01574331257636004 lr: 0.0
Epoch 5, global_step 11000 average loss: 0.022219083057127137 lr: 0.0
Epoch 5, global_step 11500 average loss: 0.011829271912152762 lr: 0.0
Epoch 5, global_step 12000 average loss: 0.014207833755743195 lr: 0.0

/kuacc/users/eacikgoz17/.conda/envs/eacikgoz17/lib/python3.8/site-packages/transformers/optimization.py:306: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
acc: 0.965
DeprecationWarning: 'source deactivate' is deprecated. Use 'conda deactivate'.
