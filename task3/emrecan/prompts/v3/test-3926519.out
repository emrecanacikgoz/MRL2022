Setting stack size to unlimited...
core file size          (blocks, -c) 0
data seg size           (kbytes, -d) unlimited
scheduling priority             (-e) 0
file size               (blocks, -f) unlimited
pending signals                 (-i) 2061310
max locked memory       (kbytes, -l) unlimited
max memory size         (kbytes, -m) 20971520
open files                      (-n) 51200
pipe size            (512 bytes, -p) 8
POSIX message queues     (bytes, -q) 819200
real-time priority              (-r) 0
stack size              (kbytes, -s) unlimited
cpu time               (seconds, -t) unlimited
max user processes              (-u) 4096
virtual memory          (kbytes, -v) unlimited
file locks                      (-x) unlimited

Tue Aug  2 22:09:26 2022       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 470.57.02    Driver Version: 470.57.02    CUDA Version: 11.4     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  Tesla T4            Off  | 00000000:40:00.0 Off |                    0 |
| N/A   51C    P0    28W /  70W |      0MiB / 15109MiB |      6%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
Using pad_token, but it is not set yet.
Namespace(lang='fra', lr=5e-05, model='gpt2', model_name_or_path='sberbank-ai/mGPT', plm_eval_mode=False, run=3)
{
  "guid": 0,
  "label": null,
  "meta": {},
  "text_a": "me la trouv\u00e8rent-ils?",
  "text_b": "",
  "tgt_text": "trouver:IND,PST,LGSPEC1,NOM(3,PL,MASC),ACC(3,SG,FEM),DAT(1,SG),Q"
}

[[{'text': 'me la trouv√®rent-ils?', 'loss_ids': 0, 'shortenable_ids': 1}, {'text': '<mask>', 'loss_ids': 1, 'shortenable_ids': 0}], {'guid': 0, 'tgt_text': 'trouver:IND,PST,LGSPEC1,NOM(3,PL,MASC),ACC(3,SG,FEM),DAT(1,SG),Q'}]
tokenizing: 0it [00:00, ?it/s]tokenizing: 69it [00:00, 685.20it/s]tokenizing: 175it [00:00, 902.14it/s]tokenizing: 320it [00:00, 1150.23it/s]tokenizing: 469it [00:00, 1281.40it/s]tokenizing: 618it [00:00, 1353.16it/s]tokenizing: 768it [00:00, 1402.64it/s]tokenizing: 918it [00:00, 1431.73it/s]tokenizing: 1069it [00:00, 1455.04it/s]tokenizing: 1223it [00:00, 1479.84it/s]tokenizing: 1386it [00:01, 1524.54it/s]tokenizing: 1600it [00:01, 1711.74it/s]tokenizing: 1805it [00:01, 1813.14it/s]tokenizing: 2015it [00:01, 1898.41it/s]tokenizing: 2212it [00:01, 1919.59it/s]tokenizing: 2409it [00:01, 1932.92it/s]tokenizing: 2628it [00:01, 2007.30it/s]tokenizing: 2843it [00:01, 2048.90it/s]tokenizing: 3053it [00:01, 2062.47it/s]tokenizing: 3261it [00:01, 2064.70it/s]tokenizing: 3468it [00:02, 2060.09it/s]tokenizing: 3675it [00:02, 1996.04it/s]tokenizing: 3876it [00:02, 1555.54it/s]tokenizing: 4084it [00:02, 1682.60it/s]tokenizing: 4294it [00:02, 1789.68it/s]tokenizing: 4501it [00:02, 1864.32it/s]tokenizing: 4702it [00:02, 1903.48it/s]tokenizing: 4909it [00:02, 1947.83it/s]tokenizing: 5109it [00:02, 1934.92it/s]tokenizing: 5306it [00:03, 1922.47it/s]tokenizing: 5509it [00:03, 1951.76it/s]tokenizing: 5717it [00:03, 1988.36it/s]tokenizing: 5920it [00:03, 1998.79it/s]tokenizing: 6126it [00:03, 2016.63it/s]tokenizing: 6329it [00:03, 2010.69it/s]tokenizing: 6539it [00:03, 2035.79it/s]tokenizing: 6743it [00:03, 2029.83it/s]tokenizing: 6947it [00:03, 2031.19it/s]tokenizing: 7158it [00:03, 2054.04it/s]tokenizing: 7373it [00:04, 2081.38it/s]tokenizing: 7582it [00:04, 1808.32it/s]tokenizing: 7789it [00:04, 1877.75it/s]tokenizing: 7995it [00:04, 1928.22it/s]tokenizing: 8192it [00:04, 1919.20it/s]tokenizing: 8387it [00:04, 1902.58it/s]tokenizing: 8580it [00:04, 1908.19it/s]tokenizing: 8783it [00:04, 1941.59it/s]tokenizing: 8986it [00:04, 1967.09it/s]tokenizing: 9189it [00:04, 1985.51it/s]tokenizing: 9389it [00:05, 1969.83it/s]tokenizing: 9587it [00:05, 1965.01it/s]tokenizing: 9784it [00:05, 1957.55it/s]tokenizing: 9980it [00:05, 1945.13it/s]tokenizing: 10000it [00:05, 1846.81it/s]
tokenizing: 0it [00:00, ?it/s]tokenizing: 439it [00:00, 4382.34it/s]tokenizing: 889it [00:00, 4451.13it/s]tokenizing: 1000it [00:00, 4430.14it/s]
tokenizing: 0it [00:00, ?it/s]tokenizing: 532it [00:00, 5315.77it/s]tokenizing: 1000it [00:00, 5152.69it/s]Epoch 0, global_step 500 average loss: 22.9911504573822 lr: 4.75e-05
Epoch 0, global_step 1000 average loss: 5.631738554954529 lr: 4.5e-05
Epoch 0, global_step 1500 average loss: 2.5994289104640482 lr: 4.25e-05
Epoch 0, global_step 2000 average loss: 1.8966574538201093 lr: 4e-05
acc: 0.683
Epoch 1, global_step 2500 average loss: 1.380935741521418 lr: 3.7500000000000003e-05
Epoch 1, global_step 3000 average loss: 1.178789021900855 lr: 3.5e-05
Epoch 1, global_step 3500 average loss: 1.0268833655249328 lr: 3.2500000000000004e-05
Epoch 1, global_step 4000 average loss: 0.9714721072553657 lr: 3e-05
acc: 0.765
Epoch 2, global_step 4500 average loss: 0.7389465790232643 lr: 2.7500000000000004e-05
Epoch 2, global_step 5000 average loss: 0.6980588973502163 lr: 2.5e-05
Epoch 2, global_step 5500 average loss: 0.7252200882611797 lr: 2.25e-05
Epoch 2, global_step 6000 average loss: 0.6620653099310584 lr: 2e-05
acc: 0.755
Epoch 3, global_step 6500 average loss: 0.4933398160407669 lr: 1.75e-05
Epoch 3, global_step 7000 average loss: 0.46032706980455257 lr: 1.5e-05
Epoch 3, global_step 7500 average loss: 0.4668790278797969 lr: 1.25e-05
Epoch 3, global_step 8000 average loss: 0.48099510684900454 lr: 1e-05
acc: 0.765
Epoch 4, global_step 8500 average loss: 0.3325543371835956 lr: 7.5e-06
Epoch 4, global_step 9000 average loss: 0.3481540494102519 lr: 5e-06
Epoch 4, global_step 9500 average loss: 0.3174666136122178 lr: 2.5e-06
Epoch 4, global_step 10000 average loss: 0.29716739212228277 lr: 0.0
acc: 0.784
Epoch 5, global_step 10500 average loss: 0.24883202811970842 lr: 0.0
Epoch 5, global_step 11000 average loss: 0.23744167889394158 lr: 0.0
Epoch 5, global_step 11500 average loss: 0.2516388106008235 lr: 0.0
Epoch 5, global_step 12000 average loss: 0.23877491226585698 lr: 0.0

/kuacc/users/eacikgoz17/.conda/envs/eacikgoz17/lib/python3.8/site-packages/transformers/optimization.py:306: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
acc: 0.784
DeprecationWarning: 'source deactivate' is deprecated. Use 'conda deactivate'.
