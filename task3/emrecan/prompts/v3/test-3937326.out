Setting stack size to unlimited...
core file size          (blocks, -c) 0
data seg size           (kbytes, -d) unlimited
scheduling priority             (-e) 0
file size               (blocks, -f) unlimited
pending signals                 (-i) 2061323
max locked memory       (kbytes, -l) unlimited
max memory size         (kbytes, -m) 20971520
open files                      (-n) 51200
pipe size            (512 bytes, -p) 8
POSIX message queues     (bytes, -q) 819200
real-time priority              (-r) 0
stack size              (kbytes, -s) unlimited
cpu time               (seconds, -t) unlimited
max user processes              (-u) 4096
virtual memory          (kbytes, -v) unlimited
file locks                      (-x) unlimited

Wed Aug  3 19:39:32 2022       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 470.57.02    Driver Version: 470.57.02    CUDA Version: 11.4     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  Tesla T4            Off  | 00000000:1C:00.0 Off |                    0 |
| N/A   33C    P0    25W /  70W |      0MiB / 15109MiB |      0%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
Using pad_token, but it is not set yet.
Namespace(lang='fra', lr=5e-05, model='gpt2', model_name_or_path='sberbank-ai/mGPT', plm_eval_mode=False, run=3)
{
  "guid": 0,
  "label": null,
  "meta": {},
  "text_a": "me la trouv\u00e8rent-ils?",
  "text_b": "",
  "tgt_text": "trouver:IND;PST;LGSPEC1;NOM(3,PL,MASC);ACC(3,SG,FEM);DAT(1,SG);Q"
}

[[{'text': 'me la trouv√®rent-ils?', 'loss_ids': 0, 'shortenable_ids': 1}, {'text': '<mask>', 'loss_ids': 1, 'shortenable_ids': 0}], {'guid': 0, 'tgt_text': 'trouver:IND;PST;LGSPEC1;NOM(3,PL,MASC);ACC(3,SG,FEM);DAT(1,SG);Q'}]
tokenizing: 0it [00:00, ?it/s]tokenizing: 204it [00:00, 2037.57it/s]tokenizing: 419it [00:00, 2102.61it/s]tokenizing: 636it [00:00, 2130.52it/s]tokenizing: 854it [00:00, 2149.22it/s]tokenizing: 1071it [00:00, 2156.05it/s]tokenizing: 1290it [00:00, 2164.51it/s]tokenizing: 1507it [00:00, 2162.31it/s]tokenizing: 1729it [00:00, 2177.91it/s]tokenizing: 1947it [00:00, 2176.88it/s]tokenizing: 2165it [00:01, 2154.46it/s]tokenizing: 2381it [00:01, 2138.98it/s]tokenizing: 2603it [00:01, 2162.62it/s]tokenizing: 2822it [00:01, 2169.07it/s]tokenizing: 3039it [00:01, 2158.83it/s]tokenizing: 3260it [00:01, 2173.51it/s]tokenizing: 3478it [00:01, 2167.71it/s]tokenizing: 3695it [00:01, 2163.02it/s]tokenizing: 3912it [00:01, 1740.03it/s]tokenizing: 4125it [00:01, 1838.79it/s]tokenizing: 4340it [00:02, 1921.52it/s]tokenizing: 4555it [00:02, 1983.65it/s]tokenizing: 4774it [00:02, 2041.57it/s]tokenizing: 4993it [00:02, 2083.21it/s]tokenizing: 5208it [00:02, 2100.56it/s]tokenizing: 5422it [00:02, 2110.44it/s]tokenizing: 5637it [00:02, 2121.45it/s]tokenizing: 5854it [00:02, 2134.16it/s]tokenizing: 6070it [00:02, 2140.89it/s]tokenizing: 6289it [00:02, 2155.21it/s]tokenizing: 6505it [00:03, 2153.02it/s]tokenizing: 6724it [00:03, 2162.30it/s]tokenizing: 6941it [00:03, 2161.95it/s]tokenizing: 7158it [00:03, 2164.31it/s]tokenizing: 7376it [00:03, 2166.67it/s]tokenizing: 7593it [00:03, 2157.01it/s]tokenizing: 7813it [00:03, 2169.68it/s]tokenizing: 8031it [00:03, 2164.21it/s]tokenizing: 8248it [00:03, 2163.31it/s]tokenizing: 8465it [00:04, 2159.64it/s]tokenizing: 8685it [00:04, 2170.73it/s]tokenizing: 8903it [00:04, 2169.19it/s]tokenizing: 9120it [00:04, 2158.94it/s]tokenizing: 9338it [00:04, 2164.26it/s]tokenizing: 9556it [00:04, 2166.98it/s]tokenizing: 9773it [00:04, 2166.20it/s]tokenizing: 9991it [00:04, 2167.69it/s]tokenizing: 10000it [00:04, 2123.01it/s]
tokenizing: 0it [00:00, ?it/s]tokenizing: 461it [00:00, 4600.02it/s]tokenizing: 922it [00:00, 4594.01it/s]tokenizing: 1000it [00:00, 4579.74it/s]
tokenizing: 0it [00:00, ?it/s]tokenizing: 542it [00:00, 5413.35it/s]tokenizing: 1000it [00:00, 5398.10it/s]Epoch 0, global_step 500 average loss: 22.488564482688904 lr: 4.75e-05
Epoch 0, global_step 1000 average loss: 5.742302277088165 lr: 4.5e-05
Epoch 0, global_step 1500 average loss: 2.6995346727371214 lr: 4.25e-05
Epoch 0, global_step 2000 average loss: 1.9009873115941882 lr: 4e-05
acc: 0.727
Epoch 1, global_step 2500 average loss: 1.3137785386890173 lr: 3.7500000000000003e-05
Epoch 1, global_step 3000 average loss: 1.1849008571561426 lr: 3.5e-05
Epoch 1, global_step 3500 average loss: 1.0066333493320272 lr: 3.2500000000000004e-05
Epoch 1, global_step 4000 average loss: 0.9108358200974762 lr: 3e-05
acc: 0.754
Epoch 2, global_step 4500 average loss: 0.7781179787898436 lr: 2.7500000000000004e-05
Epoch 2, global_step 5000 average loss: 0.6884254156826064 lr: 2.5e-05
Epoch 2, global_step 5500 average loss: 0.6082772471120116 lr: 2.25e-05
Epoch 2, global_step 6000 average loss: 0.6117263353742892 lr: 2e-05
acc: 0.792
Epoch 3, global_step 6500 average loss: 0.506318606133922 lr: 1.75e-05
Epoch 3, global_step 7000 average loss: 0.4702348804036737 lr: 1.5e-05
Epoch 3, global_step 7500 average loss: 0.4741979611554416 lr: 1.25e-05
Epoch 3, global_step 8000 average loss: 0.4025380465858034 lr: 1e-05
acc: 0.799
Epoch 4, global_step 8500 average loss: 0.33711630095590955 lr: 7.5e-06
Epoch 4, global_step 9000 average loss: 0.30195711210003356 lr: 5e-06
Epoch 4, global_step 9500 average loss: 0.29788488178432454 lr: 2.5e-06
Epoch 4, global_step 10000 average loss: 0.28962092406512235 lr: 0.0
acc: 0.787
Epoch 5, global_step 10500 average loss: 0.2243279897168104 lr: 0.0
Epoch 5, global_step 11000 average loss: 0.2269589087946224 lr: 0.0
Epoch 5, global_step 11500 average loss: 0.20246634684783932 lr: 0.0
Epoch 5, global_step 12000 average loss: 0.28800498902070104 lr: 0.0
acc: 0.787
Epoch 6, global_step 12500 average loss: 0.21305460818723077 lr: 0.0
Epoch 6, global_step 13000 average loss: 0.24231070884567452 lr: 0.0
Epoch 6, global_step 13500 average loss: 0.2455770774841658 lr: 0.0
Epoch 6, global_step 14000 average loss: 0.22706682967141387 lr: 0.0
acc: 0.787
Epoch 7, global_step 14500 average loss: 0.21976386357443697 lr: 0.0
Epoch 7, global_step 15000 average loss: 0.20889282800318323 lr: 0.0
Epoch 7, global_step 15500 average loss: 0.2513477110278327 lr: 0.0
Epoch 7, global_step 16000 average loss: 0.23458549149426836 lr: 0.0
acc: 0.787
Epoch 8, global_step 16500 average loss: 0.23035562512744218 lr: 0.0
Epoch 8, global_step 17000 average loss: 0.19591581660107477 lr: 0.0
Epoch 8, global_step 17500 average loss: 0.22202588543969615 lr: 0.0
Epoch 8, global_step 18000 average loss: 0.24755727678729453 lr: 0.0

/kuacc/users/eacikgoz17/.conda/envs/eacikgoz17/lib/python3.8/site-packages/transformers/optimization.py:306: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
acc: 0.787
DeprecationWarning: 'source deactivate' is deprecated. Use 'conda deactivate'.
